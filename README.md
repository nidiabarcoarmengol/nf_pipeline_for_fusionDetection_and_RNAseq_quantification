Nextflow pipeline for fusion detection and RNAseq quantification
================
Nidia Barco Armengol

This pipeline consists of 12 modules and 22 processes dedicated to
RNAseq paired-end data processing, covering both alignment and read
counting. It supports the use of various tools, such as Kallisto, STAR,
FeatureCounts, and HTSeq. Additionally, it enables the detection of gene
fusions using tools like Arriba, STAR-Fusion, FusionCatcher, and CICERO.

The pipeline has been specifically designed to process RNAseq samples
from patients with acute myeloid leukemia (AML), with the goal of
improving the classification of AML subtypes by incorporating gene
expression data analysis into the classification based on the presence
of specific gene fusions.

The pipeline produces three main results:

1.  Fusion results for each sample, along with two .csv files that
    summarize the outcomes from all the tools used.

2.  An HTML report that includes all quality control results for each
    sample.

3.  A count matrix with data from the processed samples.

## Modules:

**1. OrderFiles_FastQC Module:** This module includes a process that
organizes the R1 and R2 documents of the same sample into a subfolder,
performs quality control of the fastq files using the FastQC tool, and
finally returns the directory of the created folder.

**2. Arriba Module:** This module contains a process that detects
fusions using the Arriba tool. It takes as input the directory returned
by the CreateDir process (from the
Module_OrderFiles_FastQC_rnaSeq_workflow.nf) and returns the directory
containing the results of the process.

**3. CICERO Module:** This module contains a process that detects
fusions using the CICERO tool. It uses as input the BAM file created by
the STAR aligner and returns the directory containing the results of the
process.

**4. FusionCatcher Module:** This module contains a process that detects
fusions using the FusionCatcher tool. It takes as input the directory
returned by the CreateDir process (from the
Module_OrderFiles_FastQC_rnaSeq_workflow.nf) and returns the directory
containing the results of the process.

**5. STAR_Fusion Module:** This module contains a process that detects
fusions using the STAR-Fusion tool. It takes as input the directory
returned by the CreateDir process (from the
Module_OrderFiles_FastQC_rnaSeq_workflow.nf) and returns the directory
containing the results of the process.

**6. Fusions_resume Module:** This module contains a process that
generates summary files of the detected fusions, using the results
generated by the processes that run the fusion detection tools.

**7. Kallisto Module:** This module contains a process to run the
Kallisto pseudoaligner, which quantifies the transcripts from the fastq
files. It takes as input the directory generated by the CreateDir
process (from the Module_OrderFiles_FastQC_rnaSeq_workflow.nf) and
returns the directory with all the generated results.

**8. STAR_alignment Module:** This module contains three processes that
perform an alignment with STAR using the directory created by the
CreateDir process (from the Module_OrderFiles_FastQC_rnaSeq_workflow.nf)
and returns the path to the BAM file generated by the alignment.

**9. Counts_matrix Module:** This module generates the count matrix from
the BAM file created by STAR, using two possible tools: htseq and
featurecounts.

**10. QC_bam Module:** This module includes different processes to
perform quality control of the BAM files generated by STAR, using
functions from the RSeQC package.

**11. Qualimap Module:** This module contains a process that performs
quality control of the BAM file resulting from the STAR alignment using
the Qualimap tool.

**12. MultiQC_report Module:** This module contains a process that makes
quality control report with multiQC tool.

## Global workflow:

The global workflow executes all the processes available in the
pipeline’s modules. The processing of a sample begins with the execution
of the process in the OrderFiles_FastQC module. After that, the workflow
allows for the simultaneous execution of the processes in the Arriba,
FusionCatcher, STAR_Fusion, and Kallisto modules, as well as a
sub-workflow that sequentially runs the three processes in the
STAR_alignment module.

Next, using the BAM file generated by STAR_alignment, the pipeline
allows for the simultaneous execution of the processes in the CICERO,
Counts_matrix, QC_bam, and Qualimap modules.

Finally, the results from all fusion detectors are used to execute the
process in the Fusions_resume module. And from the outputs of all
quality control checks are then used to execute the process in the
MultiQC_report module.

### Execution:

To run the global workflow, you need to provide the –directory parameter
from the command line, specifying the full path to the directory
containing the paired-end RNAseq fastq.gz files. Additionally, before
executing the workflow, make sure to complete the list of parameters in
the workflow file (Global_workflow.nf).

``` bash

./Global_workflow.nf --directory <directory> 
```

## Pipeline requirments

To use the pipeline, you need the following:

1.  Nextflow version 20.10.0.

2.  14 Conda environments installed for the different processes.

3.  Docker with the CICERO tool.

Make sure you have everything set up to ensure the pipeline runs
propertly.
